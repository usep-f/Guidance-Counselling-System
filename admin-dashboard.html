<!doctype html>
<html lang="en" class="guard-pending">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Admin Dashboard | Guidance System</title>

    <!-- INSTANT GUARD: prevents any flash before external CSS loads -->
    <style>
      html.guard-pending body {
        visibility: hidden;
      }
    </style>

    <link rel="stylesheet" href="style.css" />
  </head>

  <body>
    <!-- NAVBAR -->
    <header class="site-header" id="top">
      <nav class="navbar">
        <a
          class="brand"
          href="index.html#top"
          aria-label="Guidance System Home"
        >
          <span class="brand__logo" aria-hidden="true"></span>
          <span class="brand__text">Guidance System</span>
        </a>

        <button
          class="nav-toggle"
          type="button"
          aria-label="Toggle navigation"
          aria-expanded="false"
        >
          <span class="nav-toggle__bar"></span>
          <span class="nav-toggle__bar"></span>
          <span class="nav-toggle__bar"></span>
        </button>

        <div class="nav-links" data-nav>
          <a class="nav-link" href="index.html#home">Home</a>
          <a class="nav-link" href="index.html#services">Services</a>
          <a class="nav-link" href="index.html#contact">Contact</a>
        </div>

        <a class="btn btn--pill btn--primary nav-cta" href="index.html#login">
          Login / Register
          <span class="btn__icon" aria-hidden="true">→</span>
        </a>

        <button
          class="btn btn--pill btn--ghost"
          id="logoutBtn"
          type="button"
          style="display: none"
        >
          Logout
        </button>
      </nav>
    </header>

    <main class="page">
      <section class="page-hero">
        <h1 class="page-title">Admin Dashboard (Placeholder)</h1>
        <p class="page-subtitle">
          This page should only be accessible by the admin account.
        </p>
      </section>

      <section class="page-card">
        <p>
          Later we will put analytics, student concerns summaries, and session
          reports here.
        </p>
      </section>
    </main>

    <script type="module">
      import "./site-auth-ui.js";
      import { watchAuthState, isAdminUser } from "./auth-backend.js";

      watchAuthState(async (user) => {
        if (!user) {
          sessionStorage.setItem("postAuthRedirect", "admin-dashboard.html");
          window.location.href = "index.html#login";
          return;
        }

        const ok = await isAdminUser(user);
        if (!ok) {
          window.location.href = "dashboard.html";
          return;
        }

        // ✅ Admin confirmed: allow page to show
        document.documentElement.classList.remove("guard-pending");
      });
    </script>
  </body>
</html>
